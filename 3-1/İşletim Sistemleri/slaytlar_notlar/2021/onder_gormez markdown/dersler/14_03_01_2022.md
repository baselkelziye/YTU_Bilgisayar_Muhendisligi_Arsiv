# 14. Hafta - 3 Ocak 2022 Pazartesi


# Chapter 8: Main Memory

Main memory yi utilize etmek için birden çok process i main memory de tutmamız lazım.  

* Main memory and registers are only storage CPU can access directly
* Memory unit only sees a stream of addresses + read request, or address + data and write requests
* **Cache** sits between main memory and CPU registers
* Main memory can take many cycles, causing a **stall**
* Main memory ye erişirken oluşan bekleme zamanlarında CPU nun başka şeyler çalıştırması sağlanır.

**Stall:** (of a motor vehicle or its engine) stop running, typically because of an overload on the engine.

## Base and Limit Registers
* A pair of **base** and **limit** define logical address space
* base + limit <= Main memory
  * Else trap of address violation

## Address Binding
* Programın içerisinde belirli kısımlar adress içerir. Bu adreslerin değerleri yüklenecek olan main memory bölgesine göre güncellenir.
* **Compile time:** If memory location known at compile time, **absolute code** can be generated; must recompile code if starting location changes
* **Load time:** Must generate **relocatable code** if memory location is not known at compile time
* **Execution time:** Binding delayed until run time if the process can be moved during its execution from one memory segment to another

## Logical vs. Physical Address Space

* **Logical address** generated by the CPU; also referred to as **virtual address**
* **Physical address** seen by the memory unit

## Memory Management Unit (MMU)
Hardware device that at run time map to physical address


## Dynamic Linking
* **Static linking** system libraries and program code combined by the loader into the binary program image
* **Dynamic linking** also known as **shared library**

## Swapping
Memory de yer kalmadıysa, kullanılmayan bir programı main memory den çıkar, çalışmasını istediğimiz process i main memory ye al.  
**Swap Out:** Main memory den secondary storage a  
**Swap In:** Secondary storage dan main memory ye  

Swap edilecek olan process in ready queue da bekleyen bir process olması iyi olur. IO bekleyen i memory ye alırsak daha fazla kopyalama nedeniyle yavaşlama olur.

Linux'ta kurulum sırasında belirlenen takas alanı bu durum ile ilgilidir.

## Contiguous Allocation
* Contiguous allocation is one early method
* Main memory usually split into two **partitions**:
  * Resident operating system partition, usually held in low memory with interrupt vector
  * User processes partition then held in high memory
  * Each process contained in single contiguous section of memory
* Relocation registers used to protect user process from other user processes

## Multiple Partition Allocation
* **Variable partition** sizes for efficiency (sized to an given process' needs)
* **Hole** block of available memory; holes of various size are scattered throughout memory

## Dynamic Storage Allocation Problem
How to satisfy a request of size n from a list of free holes?
* **First Fit:** Allocate the **first** hole that is big enough
* **Best Fit:** Allocate the **smallest** hole that is big enough; must search entire list, unless ordered by size
  * Produces the smallest leftover hole
* **Worst Fit:** Allocate the **largest** hole; must also search entire list
  * Produces the largest leftover hole

First fit and best fit better than worst fit in terms of speed and storage utilization

## Fragmentation
**External Fragmentation:** Total memory space exist to satisfy a request, but it is not contiguous  
**Internal Fragmentation:** Allocated memory may be slightly larger than requested

## Segmentation
Fragmentation ı azaltmak için tüm process için contiguous memory alanı oluşturmak yerine, processleri segmentlere ayırarak, bu segmentleri contiguous memory alanına koyacağız. Daha küçük program parçacıkları olduğu için memory daha verimli kullanılacaktır.

* main program
* procedure
* function
* method
* object
* local variables, global variables
* common block
* stack
* symbol table
* arrays  

**Segment table** maps two dimensional physical addresses, each table entry has:
  * **Base** contains the starting physical address where the segments reside in memory
  * **Limit** specifies the length of the segment

NOTE: Çoktan çok seçmeli final sınavı. Laboratuvar dahil olacak şekilde sorular sorulacaktır.